## 空间变换

## 散射 PDF 与采样 PDF
    Pdf 采样过程中应该返回一个 pdf
    
## 对光源采样

## 背景贴图

## 已解决问题
- 黑斑
    玻璃球、金属球表面的反射会出现黑斑
    
    Debug：把金属球和玻璃球交换位置，看是否还有黑斑出来 （金属球在在光源边界依然出现黑斑，但玻璃球没有出现黑斑）
    Debug：背景颜色修改成白色，黑斑点变成白色
    Debug：对 (459, 451) (459, 556) (516, 498) 两处坐标打断点 （依据PDF采样时，切线空间的计算没有单位化）

- Cornel Box 的 Front 墙面中心总是黑的，看起来就像磨砂金属
    Debug：不对光源采样，采用随机采样，对中心点打断点 (漫反射物体的PDF函数在计算切线空间时没有单位化)

- 射线从内部击中金属球
    Debug：击中金属球的射线，其 step 非常小，且起始位置就在金属球表面，击中点也是次位置附近。（float 类型导致精度损失，用 double 即可）

## 未解决的问题

- Bitmap 的写入策略替换

- OpenMP 到底是什么？应该如何配置

- 条带
    图像中心出现十字条带(修改切线空间后消失，不清楚是不是这个原因)

- Shadow Ray
   - Dielectric 材质，采用自带 PDF 散射
   - 非 Dielectric
        - 单光源
            - 采样 Shadow Ray，Shadow Ray 判定是否可以对光源采样（无遮挡/击中正光面），是：依概率选择是否对光源采样，计算混合 PDF；否：计算自带 PDF
        - 多光源
            - 只采样单个光源，则可以随机选取一个光源，按照上述步骤进行即可

- 电解质折射率问题
    无法在光线传输过程中确定碰撞位置两端的折射率。程序采用的是将外界材质的折射率固定设置为空气折射率（1.0）
    
- 只考虑了单个光源情况

- 添加多种光的类型

- 添加 Model 类型

- RGB 类型 -> Spectrum 类型
    评估 Light Unit 的指标
    
## 一些想法
- 新的光线追踪想法：不需要像 Path Tracing 一次性把 shader color 求解出来，而是多次迭代。每次迭代只让光线反射一次，迭代 N 轮让
    结果收敛。 
    
- 编译 PBRT，对 SamplerIntegrator::Render() 做 debug